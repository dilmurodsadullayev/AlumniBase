{% extends "alumni/base.html" %}
{% load static %}
{% block title %} Bosh sahifa{% endblock %}
{% block content %}
<div class="container-fluid p-4">
<div class="carousel-container position-relative">
  <!-- Social Icons -->
<!--  <div class="social-icons position-absolute top-50 start-0 translate-middle-y">-->
<!--    <a href="https://web.telegram.org/k/#@UBTUIT_official" target="_blank"><img src="{% static 'images/icons/telegram.png' %}" alt="Telegram"></a>-->
<!--    <a href="https://www.facebook.com/UBTUIT/" target="_blank"><img src="{% static 'images/icons/facebook.png' %}" alt="Facebook"></a>-->
<!--    <a href="https://www.instagram.com/tatuurganchfiliali_official/" target="_blank"><img src="{% static 'images/icons/instagram.png' %}" alt="Instagram"></a>-->
<!--    <a href="https://www.youtube.com/@ubtuit_official" target="_blank"><img src="{% static 'images/icons/youtube.png' %}" alt="YouTube"></a>-->
<!--  </div>-->
<div class="container-fluid mb-5">
    <div class="row">
        <div class="col-md-8" style="height: 70vh;border-radius: 20px;">
            <video autoplay muted loop style="width: 100%;height: 70vh;border-radius: 15px;" class="rounded-lg">
                <source src="{%  static 'videos/ubtuit_vd.mp4' %}">
            </video>
        </div>
        <div class="col-md-4" style="height: 70vh;border-radius: 20px;">
            <video autoplay muted loop style="width: 100%;height: 70vh;border-radius: 15px;" class="rounded-lg">
                <source src="{%  static 'videos/tatuuf.MP4' %}">
            </video>
        </div>
    </div>
</div>


    <div class="row text-center mb-4">
        <div class="col-md-3 mb-3">
            <a href="{% url 'graduate_state' %}?type=bitiruvchilar" class="text-decoration-none text-reset">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <svg width="60" height="60" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0 0 0)">
                            <path d="M11.7023 4.05965C11.8923 3.97751 12.1077 3.97751 12.2977 4.05965L21.5477 8.05965C21.8222 8.17838 22 8.44891 22 8.74805V15.4688C22 15.883 21.6642 16.2188 21.25 16.2188C20.8358 16.2188 20.5 15.883 20.5 15.4688V9.88949L12.2977 13.4355C12.1077 13.5177 11.8923 13.5177 11.7023 13.4355L2.45233 9.43555C2.17795 9.31675 2 9.04707 2 8.74805C2 8.44891 2.17775 8.17838 2.45232 8.05965L11.7023 4.05965Z" fill="#343C54"/>
                            <path d="M5.125 11.6808V16.6758C5.125 16.8216 5.16749 16.9642 5.24727 17.0862C5.24727 17.0862 5.24694 17.0857 5.24814 17.0875L5.2492 17.0892L5.25188 17.0932L5.25947 17.1045C5.26553 17.1135 5.27359 17.1252 5.28365 17.1396C5.30378 17.1684 5.33196 17.2076 5.36827 17.2558C5.44085 17.3522 5.54621 17.4849 5.68494 17.6416C5.96196 17.9546 6.375 18.3668 6.9293 18.7781C8.04166 19.6034 9.72592 20.4258 12 20.4258C14.2741 20.4258 15.9583 19.6034 17.0707 18.7781C17.625 18.3668 18.038 17.9546 18.3151 17.6416C18.4538 17.4849 18.5591 17.3522 18.6317 17.2558C18.668 17.2076 18.6962 17.1684 18.7163 17.1396C18.7264 17.1252 18.7345 17.1135 18.7405 17.1045L18.7481 17.0932L18.7508 17.0892L18.7527 17.0862C18.8325 16.9642 18.875 16.8216 18.875 16.6758V11.6808L12.6946 14.3534C12.2514 14.5451 11.7486 14.5451 11.3054 14.3534L5.125 11.6808Z" fill="#343C54"/>
                        </svg>
                        <h5 class="card-title">Bitiruvchilar</h5>
                        <p class="card-text fs-4">{{ graduates_count }} ta</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-3">
            <a href="{% url 'graduate_state' %}?type=ishga-joylashganla" class="text-decoration-none text-reset">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <svg width="60" height="60" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0 0 0)">
                            <path d="M7.74996 5.75C7.74996 4.50736 8.75732 3.5 9.99996 3.5H14C15.2426 3.5 16.25 4.50736 16.25 5.75V6.5H19.25C20.4926 6.5 21.5 7.50736 21.5 8.75V11H14.5816C14.3007 10.4088 13.6981 10 13 10H11C10.3019 10 9.69927 10.4088 9.41841 11H2.49976V8.75C2.49976 7.50736 3.50712 6.5 4.74976 6.5H7.74996V5.75ZM9.24996 6.5H14.75V5.75C14.75 5.33579 14.4142 5 14 5H9.99996C9.58574 5 9.24996 5.33579 9.24996 5.75V6.5Z" fill="#343C54"/>
                            <path d="M2.49976 12.5V17.75C2.49976 18.9926 3.50712 20 4.74976 20H19.25C20.4926 20 21.5 18.9926 21.5 17.75V12.5H14.5816C14.3007 13.0912 13.6981 13.5 13 13.5H11C10.3019 13.5 9.69927 13.0912 9.41841 12.5H2.49976Z" fill="#343C54"/>
                        </svg>
                        <h5 class="card-title">Ishga joylashgan</h5>
                        <p class="card-text fs-4">{{ ishlayotganlar }} ta</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-3">
            <a href="{% url 'graduate_state' %}?type=ishsizlar" class="text-decoration-none text-reset">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <svg width="60" height="60" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0 0 0)">
                            <path d="M3.3777 10.4603C2.9776 10.3531 2.74017 9.94185 2.84737 9.54175C3.3886 7.52186 4.58121 5.737 6.24022 4.464C7.89924 3.19099 9.93195 2.50098 12.0231 2.50098C14.1142 2.50098 16.1469 3.19099 17.806 4.464C19.2116 5.54258 20.2824 6.98861 20.9059 8.63372L21.6667 7.28239C21.8699 6.92145 22.3273 6.79358 22.6882 6.99679C23.0491 7.2 23.177 7.65734 22.9738 8.01828L21.2392 11.0993C21.1416 11.2727 20.9791 11.4001 20.7875 11.4537C20.596 11.5072 20.391 11.4825 20.2176 11.3849L17.1369 9.65017C16.776 9.44694 16.6482 8.98959 16.8514 8.62867C17.0546 8.26774 17.512 8.1399 17.8729 8.34314L19.548 9.28639C19.0303 7.85095 18.1109 6.58866 16.8928 5.65403C15.4958 4.58203 13.784 4.00098 12.0231 4.00098C10.2621 4.00098 8.55041 4.58203 7.15336 5.65403C5.75631 6.72602 4.75203 8.22904 4.29626 9.92998C4.18906 10.3301 3.7778 10.5675 3.3777 10.4603Z" fill="#343C54"/>
                            <path d="M20.6712 13.5397C21.0713 13.6469 21.3087 14.0581 21.2015 14.4582C20.6603 16.4781 19.4677 18.263 17.8087 19.536C16.1497 20.809 14.117 21.499 12.0258 21.499C9.93466 21.499 7.90195 20.809 6.24294 19.536C4.83441 18.4552 3.76209 17.0054 3.13916 15.3562L2.37242 16.718C2.16921 17.079 1.71188 17.2068 1.35094 17.0036C0.989997 16.8004 0.862131 16.3431 1.06534 15.9821L2.79997 12.9011C2.89756 12.7278 3.06001 12.6003 3.25158 12.5467C3.44316 12.4932 3.64817 12.5179 3.8215 12.6155L6.9022 14.3502C7.26313 14.5535 7.39097 15.0108 7.18773 15.3718C6.9845 15.7327 6.52715 15.8605 6.16623 15.6573L4.50355 14.721C5.02173 16.1534 5.94014 17.4129 7.15608 18.346C8.55313 19.418 10.2649 19.999 12.0258 19.999C13.7868 19.999 15.4985 19.418 16.8955 18.346C18.2926 17.274 19.2969 15.7709 19.7526 14.07C19.8598 13.6699 20.2711 13.4325 20.6712 13.5397Z" fill="#343C54"/>
                            <path d="M10.4082 9.86042C10.4082 8.96777 11.1318 8.24414 12.0245 8.24414C12.9171 8.24414 13.6408 8.96777 13.6408 9.86042C13.6408 10.7531 12.9171 11.4767 12.0245 11.4767C11.1318 11.4767 10.4082 10.7531 10.4082 9.86042Z" fill="#343C54"/>
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M10.8106 12.0869C9.57442 12.0869 8.57227 13.0891 8.57227 14.3253V15.2555C8.57227 15.6697 8.90805 16.0055 9.32227 16.0055H14.7273C15.1415 16.0055 15.4773 15.6697 15.4773 15.2555V14.3253C15.4773 13.0891 14.4752 12.0869 13.2389 12.0869H10.8106ZM10.0723 14.3253C10.0723 13.9175 10.4028 13.5869 10.8106 13.5869H13.2389C13.6467 13.5869 13.9773 13.9175 13.9773 14.3253V14.5055H10.0723V14.3253Z" fill="#343C54"/>
                        </svg>
                        <h5 class="card-title">Ishsizlar</h5>
                        <p class="card-text fs-4">{{ ishsizlar_soni }} ta</p>
                    </div>
                </div>
            </a>
        </div>
        <div class="col-md-3 mb-3">
            <a href="{% url 'companies' %}" class="text-decoration-none text-reset">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0 0 0)">
                            <path d="M12.75 14.6667C12.75 14.2524 13.0858 13.9167 13.5 13.9167H16.5C16.9142 13.9167 17.25 14.2524 17.25 14.6667C17.25 15.0809 16.9142 15.4167 16.5 15.4167H13.5C13.0858 15.4167 12.75 15.0809 12.75 14.6667Z" fill="#343C54"/>
                            <path d="M13.5 8.58334C13.0858 8.58334 12.75 8.91913 12.75 9.33334C12.75 9.74756 13.0858 10.0833 13.5 10.0833H16.5C16.9142 10.0833 17.25 9.74756 17.25 9.33334C17.25 8.91913 16.9142 8.58334 16.5 8.58334H13.5Z" fill="#343C54"/>
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 3.25C10.2574 3.25 9.25 4.25736 9.25 5.5V7.75H5.5C4.25736 7.75 3.25 8.75736 3.25 10V20C3.25 20.4142 3.58579 20.75 4 20.75H20C20.4142 20.75 20.75 20.4142 20.75 20V5.5C20.75 4.25736 19.7426 3.25 18.5 3.25H11.5ZM9.25 19.25V17H7.75586C7.34165 17 7.00586 16.6642 7.00586 16.25C7.00586 15.8358 7.34165 15.5 7.75586 15.5H9.25V13H7.75586C7.34165 13 7.00586 12.6642 7.00586 12.25C7.00586 11.8358 7.34165 11.5 7.75586 11.5H9.25V9.25H5.5C5.08579 9.25 4.75 9.58579 4.75 10V19.25H9.25ZM10.75 12.2773C10.7503 12.2683 10.7505 12.2591 10.7505 12.25C10.7505 12.2409 10.7503 12.2317 10.75 12.2227V5.5C10.75 5.08579 11.0858 4.75 11.5 4.75H18.5C18.9142 4.75 19.25 5.08579 19.25 5.5V19.25H10.75V16.2773C10.7503 16.2683 10.7505 16.2591 10.7505 16.25C10.7505 16.2409 10.7503 16.2317 10.75 16.2227V12.2773Z" fill="#343C54"/>
                        </svg>
                        <h5 class="card-title">Hamkorlar</h5>
                        <p class="card-text fs-4">{{ companies_count }} ta</p>
                    </div>
                </div>
            </a>
        </div>
    </div>

<div class="card shadow-sm mb-4">
    <div class="card-body">
        <h2 class="mb-4 text-center">Yillik ko'rsatkichlar</h2>

        <!-- YIL FILTERI -->
        <div class="mb-3 text-start">
            <label for="yearFilter" class="form-label">Yilni tanlang:</label>
            <select id="yearFilter" class="form-select" onchange="updateChart()">
                <!-- Yilni qo'shganingizni unutmaslik kerak -->
                <option value="2024">2024</option>
                <option value="2025" selected>2025</option>
            </select>
        </div>

        <div class="row justify-content-center">
            <div class="col-md-4">
                <canvas id="employmentChart"></canvas>
            </div>
        </div>
    </div>
</div>


    <div class="card shadow-sm mb-4">
       <div class="card-body">
    <h3 class="mb-4">Faoliyat Statusi</h3>

    <!-- Oliy o‘quv yurtida davom etayotganlar -->
    <div class="mb-3">
        <label class="form-label">Oliy o‘quv yurtida davom etayotganlar ({{ graduates_count }} / {{ graduates_count }})</label>
        <div class="progress">
            <div class="progress-bar bg-primary" style="width: 100%">
                100%
            </div>
        </div>
    </div>

<div class="mb-3">
    <label class="form-label">O‘z sohasida ishlayotganlar ({{ ishlayotganlar }} / {{ graduates_count }})</label>
    <div class="progress">
        <div class="progress-bar bg-success" style="width: {{ ishlayotganlar_percent }}%">
            {{ ishlayotganlar_percent }}%
        </div>
    </div>
</div>

<div class="mb-3">
    <label class="form-label">Boshqa sohada ishlayotganlar ({{ boshqa_soha }} / {{ graduates_count }})</label>
    <div class="progress">
        <div class="progress-bar bg-warning" style="width: {{ boshqa_soha_percent }}%">
            {{ boshqa_soha_percent }}%
        </div>
    </div>
</div>

<div class="mb-3">
    <label class="form-label">Ishsizlar ({{ ishsizlar_soni }} / {{ graduates_count }})</label>
    <div class="progress">
        <div class="progress-bar bg-danger" style="width: {{ ishsizlar_percent }}%">
            {{ ishsizlar_percent }}%
        </div>
    </div>
</div>

</div>

    </div>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let chart;

    // Grafikni yangilash funksiyasi
    function updateChart() {
        const selectedYear = document.getElementById('yearFilter').value;

        fetch(`/yearly-statistics/?year=${selectedYear}`)
            .then(response => response.json())
            .then(data => {
                const years = data.statistika.map(stat => stat.year);
                const sumNumbers = data.statistika.map(stat => stat.sum_number);
                const selfFields = data.statistika.map(stat => stat.self_field);
                const unemployed = data.statistika.map(stat => stat.unemployed); // Ishsizlar soni

                // Agar chart mavjud bo'lsa, uni yangilash
                if (chart) {
                    chart.destroy();
                }

                // Chart.js orqali yangi grafikni yaratish
                const ctx = document.getElementById('employmentChart').getContext('2d');
                chart = new Chart(ctx, {
                    type: 'bar', // Grafik turi
                    data: {
                        labels: years, // Yillar
                        datasets: [{
                            label: 'Hammasini Soni',
                            data: sumNumbers, // Summa sonlari
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }, {
                            label: 'O\'z sohalarining ishlaydigan',
                            data: selfFields, // O'z sohalari soni
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }, {
                            label: 'Ishsizlar soni', // Ishsizlar soni
                            data: unemployed, // Ishsizlar soni
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            })
            .catch(error => console.error('Xatolik:', error));
    }

    // Dastlabki yilni ko'rsatish
    updateChart();
</script>






{% endblock content %}